function isValid(){var n=!0,i=$(".error"),e=$("#type").val(),t,r,u,f;switch(e){case"SingleOptionQuestion":i.text("Выберите один из пунктов");t=$("#questionContent").find("input[type=radio]:checked");n=t.length!=0;n&&(n=isQuestionOptionValid(t,i));break;case"RatingQuestion":i.text("Сделайте Ваш выбор");t=$("#questionContent").find("input[type=radio]:checked");n=t.length==$(".ratingContainer").length;break;case"TextQuestion":i.text("Добавьте текст");r=$("#text").val();u=new RegExp("^ +$");n=r!=""&&!u.test(r);break;case"AcquaintanceQuestion":f=$("#content");f.submit();n=$("#content").find(".has-error").length==0}return n}function isQuestionOptionValid(n,t){var i=!0,u=$("#optionType").val(),r;switch(u){case"InputQuestionOption":t.text("Введите Ваш вариант");r=n.parents(".radioButtonContainer").find("input[type=text]").val();r==""&&(i=!1)}return i}function validateUid(n){var i=!1,r=/^[0-6]\d{2}$/.exec(n),t;return r==null?!1:(t=parseInt(n),n.length==3&&t!=NaN&&t>0&&t<=600&&(i=!0),i)}function QuestionTemplateFactory(){this.Create=function(n){var t=$("<div>"),u=$("<input>"),o,f,h,r,e,s,i,c,l;u.attr("type","hidden");u.attr("name","type");u.attr("id","type");u.val(n.Type);t.append(u);o=$("<p>");o.attr("class","error");switch(n.Type){case"SingleOptionQuestion":f=$("<input>");f.attr("type","hidden");f.attr("name","optionType");f.attr("id","optionType");t.append(f);i=$("<p>");i.text(n.Text);t.append(i);h=new QuestionOptionTemplateFactory;$.each(n.Options,function(n,i){var r=h.Create(i);t.append(r)});break;case"TextQuestion":i=$("<p>");i.text(n.Text);r=$("<textarea>");r.attr("type","text");r.attr("class","textQuestionInput");r.attr("name","text");r.attr("id","text");r.bind("input propertychange",function(){$(".error").removeAttr("style")});t.append(i);t.append(r);break;case"RatingQuestion":i=$("<p>");i.text(n.Text);t.append(i);$.each(n.Options,function(n,i){generateRatingQuestionOption(n,i,t)});break;case"AcquaintanceQuestion":e=$("<div>");e.attr("id","logo");s=$("<a>");s.attr("href",conferenceUrl);e.append(s);i=$("<p>");i.text(n.Text);c=generateTextField("nameField","&nbsp;&nbsp;Имя&nbsp;&nbsp;","name","Как мы можем к тебе обращаться?");l=generateTextField("number","Номер","uid","Номер твоего бейджа");t.append(e);t.append(i);t.append(c);t.append(l)}return t.append(o),t}}function generateRatingQuestionOption(n,t,i){var u=$("<div>"),f,e,o,s,r;for(u.attr("class","ratingOptionContainer"),f=$("<input>"),f.attr("type","hidden"),f.attr("name","["+n+"].Id"),f.val(t.Id),u.append(f),e=$("<div>"),e.attr("class","ratingContainer"),o=$("<p>"),o.text(t.Description),o.attr("class","description"),s=t.From;s<=t.To;s+=t.Step)r=$("<input>"),r.attr("type","radio"),r.attr("name","["+n+"].Rating"),r.attr("class","rating"),r.val(s),r.change(function(){$(".error").removeAttr("style")}),e.append(r);u.append(o);u.append(e);i.append(u)}function generateTextField(n,t,i,r){var e=$("<div>"),f,o,u;return e.attr("class","form-group"),e.attr("id",n),f=$("<div>"),f.attr("class","input-group"),e.append(f),o=$("<span>"),o.attr("class","input-group-addon"),o.html(t),f.append(o),u=$("<input>"),u.attr("required","required"),u.attr("id",i),u.attr("name",i),u.attr("type","text"),u.attr("class","form-control"),u.attr("placeholder",r),f.append(u),e}function QuestionOptionTemplateFactory(){function n(n){var i=$("<div>"),f,r,t,u;return i.attr("class","radioButton"),i.click(function(){$(".innerCircle").removeAttr("style");$(this).find(".innerCircle").css("display","block");var n=$(this).find("input[type=radio]"),t=n.data("type");n.prop("checked",!0).trigger("change");$("#optionType").val(t);$(".error").removeAttr("style")}),f=$("<div>"),f.attr("class","innerCircle"),r=$("<div>"),r.attr("class","circle"),r.append(f),t=$("<input>"),t.attr("type","radio"),t.attr("name","optionId"),t.attr("id","id"+n.Id),t.attr("value",n.Id),t.data("type",n.Type),u=$("<label>"),u.text(n.Text),u.attr("for","id"+n.Id),i.append(r),i.append(t),i.append(u),i}this.Create=function(t){var u=$("<div>"),r,i;u.attr("class","radioButtonContainer");switch(t.Type){case"QuestionOption":case"RedirectionQuestionOption":r=n(t);u.append(r);break;case"InputQuestionOption":r=n(t);r.attr("class","inputQuestionOption");i=$("<input>");i.attr("type","text");i.attr("id","text");i.attr("name","text");i.attr("disabled","disabled");i.attr("class","inputQuestionOptionInput");i.data("optionId",r.find("input[type=radio]").attr("id"));i.keydown(function(n){return $(".error").removeAttr("style"),n.keyCode==13?($("#next").focus(),!1):void 0});u.append(r);u.append(i);$(document).on("change","input[name=optionId]",function(){var n=i.data("optionId"),t=$(this).attr("id");n==t?i.removeAttr("disabled"):i.attr("disabled","disabled")})}return u}}function showLoader(){var n=$("#loader"),t=$("#content");centerItem(n.find("img"));t.css("opacity","0.3");n.css("height",$(".container-fluid").height());n.show()}function hideLoader(){var n=$("#loader"),t=$("#content");t.css("opacity","1");n.hide()}function displayQuestion(n){if(n==null||$.isEmptyObject(n))displayThanks();else{var r=new QuestionTemplateFactory,t=r.Create(n),i=$("#questionContent"),u=i.html()=="";i.append(t);animate(i,t,u);initStars(t)}$("#content").removeAttr("style")}function animate(n,t,i){if(i)t.attr("class","oldTemplate");else{var r=t.outerWidth();t.attr("class","newTemplate");t.css("width",r+"px");t.css("top","10px");t.css("right","-"+parseInt(r+20)+"px");n.velocity({right:parseInt(r+20)+"px"},{duration:1e3,complete:function(){t.removeAttr("style");t.removeClass("newTemplate");n.removeAttr("style");$(".oldTemplate").remove();t.addClass("oldTemplate");var i=$(".progressWrapper");i.removeAttr("style")}})}}function progressStart(n){var i=$(".progressWrapper"),t;i.removeAttr("style");t=$("#progress");createProgress(n,t);n.Answered>=0?fillProgress(n,t):i.css("visibility","hidden")}function progressNextStep(n){var t=$("#progress");n.Quantity>t.find(".step").length&&(t.empty(),createProgress(n,t));fillProgress(n,t);$(".progressWrapper").removeAttr("style")}function createProgress(n,t){for(var i,u=100/n.Quantity,r=0;r<n.Quantity;r++)i=$("<div>"),i.attr("class","step"),i.css("width",u+"%"),t.append(i)}function fillProgress(n,t){var i=t.find(".step");i.find(".current").removeClass("current");$.each(i,function(t,i){var r=$(i);t<n.Answered&&r.addClass("answered");t==n.Answered&&r.addClass("current")})}function initStars(n){var t=n.find(".ratingContainer");t.rating();$.each(t.find(".stars"),function(){var n=$(this),t=n.find(".star").length*50;n.css("width",t+"px")})}function displayThanks(){var n=$("<div>"),t,i,r;n.attr("id","logo");n.css("height","200px");t=$("<a>");t.attr("href",conferenceUrl);t.css("width","300px");n.append(t);i=$("<p>");i.attr("class","thanksText");i.text("Спасибо, что уделили нам время!");$("#questionContent").remove();$("#next").remove();$(".progressWrapper").remove();$(".push").remove();r=$(".wrapper");r.append(n);r.append(i);setKey("")}function centerItem(n){var t=$(window).height()/2-40;n.css("margin-top",window.pageYOffset+t)}function setKey(n){($.cookie("header")==undefined||$.cookie("header")!=n)&&$.cookie("header",n)}var conferenceName="syncnet",conferenceUrl="https://sync.net.ua";$(function(){$("link[rel=icon]").attr("href","styles/images/favicon/"+conferenceName+"-favicon.png")});
/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)})(function(n){function i(n){return t.raw?n:encodeURIComponent(n)}function f(n){return t.raw?n:decodeURIComponent(n)}function e(n){return i(t.json?JSON.stringify(n):String(n))}function o(n){n.indexOf('"')===0&&(n=n.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return n=decodeURIComponent(n.replace(u," ")),t.json?JSON.parse(n):n}catch(i){}}function r(i,r){var u=t.raw?i:o(i);return n.isFunction(r)?r(u):u}var u=/\+/g,t=n.cookie=function(u,o,s){var y,a,h,v,c,p;if(o!==undefined&&!n.isFunction(o))return s=n.extend({},t.defaults,s),typeof s.expires=="number"&&(y=s.expires,a=s.expires=new Date,a.setTime(+a+y*864e5)),document.cookie=[i(u),"=",e(o),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("");for(h=u?undefined:{},v=document.cookie?document.cookie.split("; "):[],c=0,p=v.length;c<p;c++){var w=v[c].split("="),b=f(w.shift()),l=w.join("=");if(u&&u===b){h=r(l,o);break}u||(l=r(l))===undefined||(h[b]=l)}return h};t.defaults={};n.removeCookie=function(t,i){return n.cookie(t)===undefined?!1:(n.cookie(t,"",n.extend({},i,{expires:-1})),!n.cookie(t))}});
/* jQuery Star Rating Plugin
 * 
 * @Author
 * Copyright Nov 02 2010, Irfan Durmus - http://irfandurmus.com/
 *
 * @Version
 * 0.3b
 *
 * @License
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Visit the plugin page for more information.
 * http://irfandurmus.com/projects/jquery-star-rating-plugin/
 *
 */
(function(n){var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABDCAYAAAAh43M3AAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAScwAAEnMBjCK5BwAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xMkMEa+wAAAabSURBVHhe5ZttbFNVGMfHmzFKjMEgIbz48kHxJdHoBzQGMfqBGIkfTDDEhIj6hQ+CaGJiJIh8MDExZOAHAlkWR0aCgAlkuFKsscFtdOtgbGxjY23p1q5r17FuXdv1bRv+D/y3uIyuvfeenVvGL2nYvfe8POd/z3me59x7KbldJMRisV78RnhoOkUjzODg4MFQKHSMh6ZTNMJcvXr1Hbfb/T4PTacohIlGo0P79u1beOrUqUXpdHqIp02lKIQJBAIVJWR4eLgollNRCFNXV/cBdSlxOp3beNpUTBcmHo9Hjh49uoS6lFRWVj6WSCSyvGwapgsTDoePU5MpEKHO8LJpmC5Md3f3ZuoxRWdnp+nLyVRhEIGGRSSiHlOUlpY+nkql0ixmCqYKMzAw8Ae1mEEkErGwmCmYKozD4dhOHWYQDAa3s5gpmCbM6OhoEtHoEeowA4vFsjybzY6zuHJMEwaRp4oa5ASJXz2LK8c0Ybxeb85lNAmi09csrhxThBERR0Qejj8nJ06cWJPJZFhLLaYIg02jlWPPC/ZODlZTiinCwHd8wXHnJRQKfcVqSlEuDJK67IEDB1Zx3Hm5ePHiM+Pj4xOsrgzlwmAG1HPMBTMyMtLI6spQLsyNGze+5XgLpqen50dWV4ZSYUSEqaysXM3xFsy5c+dexnJiK2pQKgyWhINj1YR47Im9k4vNKEGpMOFw+BuOVTM+n+8nNqMEZcKMgZqamrUcp2YuXbr02sSEuuAk7kSH2+0+Pde/69ev/8ox6qa9vf23e7Ut+wdn7y3BDjbt9/t3Q6SF7P+BRWjQ19e3R8zuqaUEx1itJ2LMF+rr61cPDQ39Szmm+5jR0dFQd3f3eyz7wODxeDZjYsQowx1mOF/kC2Mul6vUbrcvZr15y+XLl5fAxx6BU5+RJOWMSvF4vLa6uvo5tjHvgCjrMEuaOdwZ5BRGkEwmY3BGH7GteQPGtC2RSMz6FmJWYQQid4DfOeb1eh9mu/ctcA9LA4HAaQ5tVvIKMwkcc1tDQ8Or7OO+o7m5eT1WQBeHk5eChRGkUqkMQtrnYu/C/ooeYeutW7d2pdNpTbtQTcJMMjg4eNZmsz3BvouWpqam5bDVRrM1oUsYAaalr6Wl5W3aUHS0trZugoMN01zN6BZGkMlkxuHh92K6PkR7TEfYApt+RlZvaMdpSJhJotGo3Wq1rqFtpoFN5lPwgU6aZQgpwggwe8I3b978kDYqB+nEViydOM0xjDRhBOLxY39//8HZ3knL5sKFC4+izzLZz2qkCjMJ1vgh2j3nDAwMlLFbqcyJMFeuXNlKu+ecjo6Oz9itVKQLgwx5FJFhKe2ec8rLy5ejS/YuD+nChMPhs7RZGXqTuNmQLkxXV9cntFcZiEg72L00pAqD/Uiira1NebJXUVGxKpvNjtEMKUgVJhaLnaGtysFGsZZmSEGqMNja76SdygkGgztphhSkCYPIMHH48OEnaadyHA7HCiwnWmMcacJEIpF/aKNeFvBf3cj8+kqaMB6P50vap5mTJ08uQ1r/O7LY8qqqKt3bCUTEvTTHMFKEwRTOlJWVraB9mkCW/CaWoYdNiRd/rqampld4WRMWi+VFWZ+LSBEGW/1a2lYw4pFjT0/Pd2NjYyk2MwWETrrd7l0opnl5ITp1shlDSBEG2e5u2lUQ58+fX4kB/M3qOYHgZ61W6zJWKwi0u4fVDWFYGDF1GxsbV9KuvLhcrk2pVCrE6nlBbtQH/7WB1fNit9vXyXgEYVgYOM022jQr4pUvco1f7vU6NB8QP+v3+/fjz4KWFsRsv1tTP4aFwQzYT3tycu3atWfhVBtYRTfxeNwuvkpgsznBzTL89ZUhYURChVD7PO25J3CwH2PpSHvkmEgkRnp7e2f8r7j/g2RvvdHlZEiYaDSacxmJR44YwHEWlYrwa2j7SK4N68aNGxfDcQdZXBeGhEEE+IG2TAPT/fVkMml4necDy7MVs+MFdjsNCHeIxXShWxgxVRsaGl6iHXfYsmXLor6+vh1pwGJzDm5ACn1+iu6nOeba2toNLKIL3cLAEXbQhjuIfAMp/Z+8rBRxk5BLnQ4EAlPbCZxegL1T/90S2tEtDJzq1JsArPV3MUm8vGQauFnelpaWN2iW2FTqXk66hBHOD851PdL6xdhVf4/opPZ79lkQr43Fh9Ziy4EZ9BZPa0aXMHB6fiRsT8Pz1/BU0YEb9pfNZluLWZPgKU3oEqaurq4NDk/3+lWFz+frdzqdfh5q4Pbt/wAvd8s6nQQa8AAAAABJRU5ErkJggg==";n.fn.rating=function(t){t=t||function(){};this.each(function(i,r){n(r).data("rating",{callback:t}).bind("init.rating",n.fn.rating.init).bind("set.rating",n.fn.rating.set).bind("hover.rating",n.fn.rating.hover).trigger("init.rating")})};n.extend(n.fn.rating,{init:function(){for(var u=n(this),f="",e=null,i=u.children(),r=0,o=i.length;r<o;r++)f=f+'<a class="star" title="'+n(i[r]).val()+'" ><img src="'+t+'"/><a/>',n(i[r]).is(":checked")&&(e=n(i[r]).val());i.hide();u.append('<div class="stars">'+f+"<\/div>").trigger("set.rating",e);n("a",u).bind("click",n.fn.rating.click);u.trigger("hover.rating")},set:function(t,i){var f=n(this),r=n("a",f),u=undefined;i&&(r.removeClass("fullStar"),u=r.filter(function(){return n(this).attr("title")==i?n(this):!1}),u.addClass("fullStar").prevAll().addClass("fullStar"));return},hover:function(){var i=n(this),t=n("a",i);t.bind("mouseenter",function(){n(this).addClass("tmp_fs").prevAll().addClass("tmp_fs");n(this).nextAll().addClass("tmp_es")});t.bind("mouseleave",function(){n(this).removeClass("tmp_fs").prevAll().removeClass("tmp_fs");n(this).nextAll().removeClass("tmp_es")})},click:function(t){t.preventDefault();var i=n(t.target).parent(),r=i.parent().parent(),f=r.children("input"),u=i.attr("title");matchInput=f.filter(function(){return n(this).val()==u?!0:!1});matchInput.change().prop("checked",!0).siblings("input").prop("checked",!1);r.trigger("set.rating",matchInput.val()).data("rating").callback(u,t)}})})(jQuery);$(function(){var n=$("#content");n.submit(function(n){n.preventDefault()});n.validate({submitHandler:function(){var n=$("#name"),t=$("#nameField"),i=$("#number");if(i.removeClass("has-error"),n.removeClass("has-error"),n.val($.trim(n.val())),n.val().trim().length==0){n.val("");t.addClass("has-error");return}if(!/^[a-zA-Zа-яА-Я ]+$/.test(n.val())){t.addClass("has-error");return}if(!validateUid($("#uid").val())){i.addClass("has-error");$("#uid").focus();return}},highlight:function(n){$(n).closest(".form-group").addClass("has-error")},unhighlight:function(n){$(n).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(){}})});$(function(){var r=$("#content"),i=$("#loader"),t,n;i.hide();jQuery.ajaxSetup({beforeSend:function(){t=setTimeout(showLoader,1200)},complete:function(){clearTimeout(t);hideLoader()}});$.ajax({url:"api/start/",type:"GET",headers:{Authorization:"Bearer "+$.cookie("header")}}).done(function(t){n.removeAttr("style");progressStart(t);setKey(t.Key);displayQuestion(t.Question)});n=$("#next");n.click(function(){if(!isValid()){$(".error").css("display","block");return}var n=$("#type").val(),t=$("#content").serialize();$.ajax({url:"api/answer/"+n,type:"POST",data:t,headers:{Authorization:"Bearer "+$.cookie("header")}}).done(function(n){progressNextStep(n);displayQuestion(n.Question)})})});